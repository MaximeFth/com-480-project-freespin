<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DataVis Project</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">

  <!-- Load d3.js -->
  <script src="https://d3js.org/d3.v3.min.js"></script>

  <!-- load scripts for nice select; source : https://hernansartorio.com/jquery-nice-select/ -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.css" rel="stylesheet" />

  <!-- load sanskey diagram -->
  <script type="text/javascript" SameSite=None src="https://www.gstatic.com/charts/loader.js"></script>
  <script src ="js/sanskey.js"></script>

  <!-- load map modules -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  <script src="js/datamaps.all.js"></script>
  <!-- Favicons -->
  <link href="img/bb17.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Poppins:300,400,500,700" rel="stylesheet">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/animate/animate.min.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">

  <!-- =======================================================
    Theme Name: Regna
    Theme URL: https://bootstrapmade.com/regna-bootstrap-onepage-template/
    Author: BootstrapMade.com
    License: https://bootstrapmade.com/license/
    ======================================================= -->
  </head>

  <body>

  <!--==========================
  Header
  ============================-->
  <header id="header">
    <div class="container">

      <div id="logo" class="pull-left">
        <a href="#hero"><img src="img/epfl.png" alt="" title="" /></img></a>
        <!-- Uncomment below if you prefer to use a text logo -->
        <!--<h1><a href="#hero">Regna</a></h1>-->
      </div>

      <nav id="nav-menu-container">
        <ul class="nav-menu">
          <li class="menu-active"><a href="#hero">Home</a></li>
          <li><a href="#about">About Us</a></li>
          <li><a href="#team">Team</a></li>   
          <li><a href="#Visualisation">Visualisation</a></li>



        </ul>
      </nav><!-- #nav-menu-container -->
    </div>
  </header><!-- #header -->

  <!--==========================
    Hero Section
    ============================-->
    <section id="hero">
      <div class="hero-container">
        <h1>NBA Visualisation</h1>
        <h2>Project of data visualisation of EPFL </h2>
        <a href="#about" class="btn-get-started">Explore</a>
      </div>
    </section><!-- #hero -->

    <main id="main">

    <!--==========================
      About Us Section
      ============================-->
      <section id="about">
        <div class="container">
          <div class="row about-container">

            <div class="col-lg-6 content order-lg-1 order-2">
              <h2 class="title">Few Words About Us</h2>
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
              </p>

              <div class="icon-box wow fadeInUp">
                <div class="icon"><i class="fa fa-shopping-bag"></i></div>
                <h4 class="title"><a href="">Eiusmod Tempor</a></h4>
                <p class="description">Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi</p>
              </div>

              <div class="icon-box wow fadeInUp" data-wow-delay="0.2s">
                <div class="icon"><i class="fa fa-photo"></i></div>
                <h4 class="title"><a href="">Magni Dolores</a></h4>
                <p class="description">Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</p>
              </div>

              <div class="icon-box wow fadeInUp" data-wow-delay="0.4s">
                <div class="icon"><i class="fa fa-bar-chart"></i></div>
                <h4 class="title"><a href="">Dolor Sitema</a></h4>
                <p class="description">Minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat tarad limino ata</p>
              </div>

            </div>

            <div class="col-lg-6 background order-lg-2 order-1 wow fadeInRight"></div>
          </div>

        </div>
      </section><!-- #about -->




    <!--==========================
      Team Section
      ============================-->
      <section id="team">
        <div class="container wow fadeInUp">
          <div class="section-header">
            <h3 class="section-title">Team</h3>
            <p class="section-description">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque</p>
          </div>
          <div class="row">
            <div class="col-lg-3 col-md-6">
              <div class="member">
                <div class="pic"><img src="#" alt=""></div>
                <h4>Walter White</h4>
                <span>Chief Executive Officer</span>
                <div class="social">
                  <a href=""><i class="fa fa-twitter"></i></a>
                  <a href=""><i class="fa fa-facebook"></i></a>
                  <a href=""><i class="fa fa-google-plus"></i></a>
                  <a href=""><i class="fa fa-linkedin"></i></a>
                </div>
              </div>
            </div>

            <div class="col-lg-3 col-md-6">
              <div class="member">
                <div class="pic"><img src="#" alt=""></div>
                <h4>Sarah Jhinson</h4>
                <span>Product Manager</span>
                <div class="social">
                  <a href=""><i class="fa fa-twitter"></i></a>
                  <a href=""><i class="fa fa-facebook"></i></a>
                  <a href=""><i class="fa fa-google-plus"></i></a>
                  <a href=""><i class="fa fa-linkedin"></i></a>
                </div>
              </div>
            </div>

            <div class="col-lg-3 col-md-6">
              <div class="member">
                <div class="pic"><img src="#" alt=""></div>
                <h4>William Anderson</h4>
                <span>CTO</span>
                <div class="social">
                  <a href=""><i class="fa fa-twitter"></i></a>
                  <a href=""><i class="fa fa-facebook"></i></a>
                  <a href=""><i class="fa fa-google-plus"></i></a>
                  <a href=""><i class="fa fa-linkedin"></i></a>
                </div>
              </div>
            </div>

            <div class="col-lg-3 col-md-6">
              <div class="member">
                <div class="pic"><img src="#" alt=""></div>
                <h4>Amanda Jepson</h4>
                <span>Accountant</span>
                <div class="social">
                  <a href=""><i class="fa fa-twitter"></i></a>
                  <a href=""><i class="fa fa-facebook"></i></a>
                  <a href=""><i class="fa fa-google-plus"></i></a>
                  <a href=""><i class="fa fa-linkedin"></i></a>
                </div>
              </div>
            </div>
          </div>

        </div>
      </section><!-- #team -->
        <!--==========================
      Visualisation Section
      ============================-->
      <section id="Visualisation">
        <div id="content">
          <h1> Visualisation</h1>
          <!-- div for the sanskey diagram -->
          <div id ="sankeyVisu">      
          </div>

          <!-- div for the selection of teams and seasons -->
          <div id="features">
            <font size="5">
              <form name="playerName" onSubmit="return readTeamsAndYear()">
                <label for="team-select"></label>
                <select name="TeamsSelect" id="teamSelect">
                  <option value="">--Select a Team--</option>
                  <option value="GSW">Golden State Warriors</option>
                  <option value="LAC">Los Angeles Clippers</option>
                  <option value="LAL">Los Angeles Lakers</option>
                  <option value="SAC">Sacramento Kings</option>
                  <option value="DEN">Denver Nuggets</option>
                  <option value="MIA">Miami Heat</option>
                  <option value="ORL">Orlando Magic</option>
                  <option value="ATL">Atlanta Hawks</option>
                  <option value="CHI">Chicago Bulls</option>
                  <option value="IND">Indiana Pacers</option>
                  <option value="BOS">Boston Celtics</option>
                  <option value="DET">Detroit Pistons</option>
                  <option value="MIN">Minnesota Timberwolves</option>
                  <option value="NYK">New York Knicks</option>
                  <option value="CHA">Charlotte Hornets</option>
                  <option value="CLE">Cleveland Cavaliers</option>
                  <option value="OKC">Oklahoma City Thunder</option>
                  <option value="POR">Portland Trail Blazers</option>
                  <option value="PHI">Philadelphia 76ers</option>
                  <option value="MEM">Memphis Grizzlies</option>
                  <option value="DAL">Dallas Mavericks</option>
                  <option value="HOU">Houston Rockets</option>
                  <option value="SAS">San Antonio Spurs</option>
                  <option value="UTA">Utah Jazz</option>
                  <option value="MIL">Milwaukee Bucks</option>
                  <option value="WAS">Washington Wizards</option>
                  <option value="PHX">Phoenix Suns</option>
                  <option value="TOR">Toronto Raptors</option>


                </select>
                <br>
                <label for="season"></label>
                <select name="Season" id="seasonSelect">
                  <option value="">--Select a season--</option>
                  <option value="1980">1980</option>
                  <option value="1981">1981</option>
                  <option value="1982">1982</option>
                  <option value="1983">1983</option>
                  <option value="1984">1984</option>
                  <option value="1985">1985</option>
                  <option value="1986">1986</option>
                  <option value="1987">1987</option>
                  <option value="1988">1988</option>
                  <option value="1989">1989</option>
                  <option value="1990">1990</option>        
                  <option value="1991">1991</option>
                  <option value="1992">1992</option>
                  <option value="1993">1993</option>
                  <option value="1994">1994</option>
                  <option value="1995">1995</option>
                  <option value="1996">1996</option>
                  <option value="1997">1997</option>
                  <option value="1998">1998</option>
                  <option value="1999">1999</option>
                  <option value="2000">2000</option>
                  <option value="2001">2001</option>
                  <option value="2002">2002</option>
                  <option value="2003">2003</option>
                  <option value="2004">2004</option>
                  <option value="2005">2005</option>
                  <option value="2006">2006</option>
                  <option value="2007">2007</option>
                  <option value="2008">2008</option>
                  <option value="2009">2009</option>
                  <option value="2010">2010</option>
                  <option value="2011">2011</option>
                  <option value="2012">2012</option>
                  <option value="2013">2013</option>
                  <option value="2014">2014</option>
                  <option value="2015">2015</option>
                  <option value="2016">2016</option>
                  <option value="2017">2017</option>
                  <input name="Submit" class = "submit" type="submit" value="Search!" >
                </form>
              </select>
              <br>
              <br>
            </font>
            <div id = "playersBox">
              <form id="players_selected", name= "playerSelection", onSubmit = "return readPlayers()"></form>
              <!-- clear button-->
              <form name="test" onSubmit="return clearBuffer()">
                <input name="Submit" class = "Clear" type="submit" value="Clear!" >
              </form>


            </div>
            <div id = "StatDiv">
              <h2> Statistics</h2>
              <table>
                <tr>
                  <td>
                    <input type="checkbox" name = "selectedStat"  id="G"  value=G>
                    <font size =4><label for="G">Games</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="GS"  value=GS>
                    <font size =4><label for="GS">Game started</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="PER"  value=PER>
                    <font size =4><label for="PER">Player efficiency rating</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="FTr"  value=FTr>
                    <font size =4><label for="FTr">Free throw Percentage</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="ORB%"  value=ORB%>
                    <font size =4><label for="ORB%">Offensive rebound rate</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="DRB%"  value=DRB%>
                    <font size =4><label for="DRB%">Defensive Rebound rate</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="AST%"  value=AST%>
                    <font size =4><label for="AST%">Assist Percentage</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="STL%"  value=STL%>
                    <font size =4><label for="STL%">Steal Percentage</label></font><br>
                    <input type="checkbox" name = "selectedStat"  id="TOV%"  value=TOV%>
                    <font size =4><label for="TOV%">Turnover Percentage</label></font><br>
                  </div>
                </td>
                <td>
                  <input type="checkbox" name = "selectedStat"  id="3P"  value=3P>
                  <font size =4><label for="3P">3Pts</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="3PA"  value=3PA>
                  <font size =4><label for="3PA">3Pts attempts</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="3P%"  value=3P%>
                  <font size =4><label for="3P%">3Pts Percentage</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="2P"  value=2P>
                  <font size =4><label for="2P">2Pts</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="2PA"  value=2PA>
                  <font size =4><label for="2PA">2Pts attempts</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="2P%"  value=2P%>
                  <font size =4><label for="2P%">2Pts percentage</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="FT"  value=FT>
                  <font size =4><label for="FT">Free throws</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="FTA"  value=FTA>
                  <font size =4><label for="FTA">Free throws attempts</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="FT%"  value=FT%>
                  <font size =4><label for="FT%">Free throws Percentage</label></font><br>
                </td>
                <td>
                  <input type="checkbox" name = "selectedStat"  id="USG%"  value=USG%>
                  <font size =4><label for="USG%">Usage Percentage</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="ORB"  value=ORB>
                  <font size =4><label for="ORB">Offensive rebounds</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="DRB"  value=DRB>
                  <font size =4><label for="DRB">Defensive rebounds</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="AST"  value=AST>
                  <font size =4><label for="AST">Assists</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="STL"  value=STL>
                  <font size =4><label for="STL">Steals</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="BLK"  value=BLK>
                  <font size =4><label for="BLK">Blocks</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="TOV"  value=TOV>
                  <font size =4><label for="TOV">Turnovers</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="PTS"  value=PTS>
                  <font size =4><label for="PTS">Points</label></font><br>
                  <input type="checkbox" name = "selectedStat"  id="BLK%"  value=BLK%>
                  <font size =4><label for="BLK%">Block Percentage</label></font><br>

                </td>
              </tr>
            </table>
          </div>


          <div id="PlayerMap">
            <select onchange="updateMap()" name="selectPlayerMap" id="selectPlayerMap"></select>
          </div>
          <div id = "mapDiv"> 

          </div>



        </div>
      </div>


      <script>
      window.onload = function(){
        var s = document.getElementById('teamSelect').options, 
        l = 0, 
        d = '';
        for(i = 0; i < s.length; i++){
          if(s[i].text.length > l) l = s[i].text.length; 
        }
        for(i = 0; i < s.length; i++){
          d = '';  
          line = s[i].text.split(';');
          l1 = (l - line[0].length);
          for(j = 0; j < l1; j++){
            d += '\u00a0'; 
          }
          s[i].text = line[0] + d + line[1];
        }  
      };



      function updateMap(){
  //  $('#mapDiv').load(document.URL +  ' #mapDiv');

  bubbles = [];
  var playerMap = document.getElementById("selectPlayerMap").value;
  var stateAb;
  var indexTeam;
  var stateVisited = [];
   
  d3.csv("DATA/draftStates/"+(playerMap+'').slice(0,-3)+".csv").then (function(data) {
   d3.csv("DATA/teamState.csv").then (function(team) {

    for (var i = 0; i < data.length; i++) {
      for (var j = 0; j < team.length; j++) {
        if(data[i].Tm ==team[j].TeamAbr){
          stateAb = team[j].StateAbr;
          indexTeam = j;
          console.log(team[indexTeam].City);
          break;
        }};
        stateVisited.push(stateAb+'');
        if (stateAb == "ON") {bubbles.push(
        {
          city: team[indexTeam].City,
          latitude: 43.651070,
          longitude: -79.347015,
         fillKey: '1',
          numberTeam: i+1+'',
          radius: Number(data[i]["PER"]),
          year: Number(data[i]["Year"])
        }
        );}else if (stateAb == "MN") {bubbles.push(
        {
          city: team[indexTeam].City,
          latitude: 46.392410,
          longitude: -94.636230,
         fillKey: '1',
          numberTeam: i+1+'',
          radius: Number(data[i]["PER"]),
          year: Number(data[i]["Year"])
        }
        );}else{
        bubbles.push(
        {
          city: team[indexTeam].City,
          centered: stateAb+'',
          fillKey: '1',
          numberTeam: i+1+'',
          radius: Number(data[i]["PER"]),
          year: Number(data[i]["Year"])
        }
        );}

      };
      var arcs = [];
      console.log(stateVisited);
      for (var i = 0; i < stateVisited.length-1; i++) {
                  console.log(stateVisited[i]);
                  console.log(stateVisited[i+1]);



        if (stateVisited[i]==stateVisited[i+1]) {}  else if (stateVisited[i]=="ON" && stateVisited[i+1] != "ON") {
          arcs.push(
          {
            origin: {
              latitude: 43.651070,
              longitude: -79.347015
            },
            destination: stateVisited[i+1]});
        } else if (stateVisited[i]!="ON" && stateVisited[i+1] == "ON") {
          arcs.push(
          {
            origin: stateVisited[i],
            destination: {
              latitude: 43.651070,
              longitude: -79.347015
            }
        });}   else{
          arcs.push(
          {
            origin: stateVisited[i],
            destination: stateVisited[i+1]
          });};
      }; // end for


      try {
        map.arc(arcs, {strokeWidth: 3, arcSharpness: 2.4}, 
        {
          animationSpeed: 2
        });
      } catch (error) {
        console.log(error);
      }
         setTimeout(() => { // only start drawing bubbles on the map when map has rendered completely.
          map.bubbles(bubbles, {
            popupTemplate: function (geo, data) {
              return '<div class="hoverinfo">Team n°'+data.numberTeam+', Year:'+ data.year+'<br/>PER: '+data.radius+'<br/>City:'+data.city+'</div>';
            }
          });
        }, 1000); // end timeout
         return false;
       });
return false;
});
return false;
} // end function update map

var map =
new Datamap(
{

  element: document.getElementById('mapDiv'),
  responsive: true,
  scope: "usa",
  geographyConfig: {
    popupOnHover: true,
    popupTemplate: function(geography, data) {
      return '<div class="hoverinfo">' + geography.properties.name + '<br/>Number of players: <Strong>' +  data.Number_of_players + '</strong> '
    },
    borderColor: '#444',
    borderWidth: 1.5
  },
  fills: {
    '1':'rgba(200,10,10,3)',
    '2':'#b3b3ff',
    '3':'#8080ff',
    '4':'#4d4dff',
    '5':'#1a1aff',
    '6':'#0000cc',
    '7':'#000099',
    '8':'#00001a',
    'MEDIUM':'#0fa0fa',
    'MINOR':'#bada55',
    'Low':'#e6e6ff',
    'Small':'#b3b3ff',
    'Medium':'#8080ff',
    'Large':'#4d4dff',
    'Huge':'rgba(20,20,255,1)',
    defaultFill: 'rgba(20,20,135,0.2)'
  },
  data: {
    "CA": {
     "fillKey": "Huge",
     "Number_of_players":343+296+263+367
   },

   "CO": {
     "fillKey": "Medium",
     "Number_of_players":307
   },

   "FL": {
     fillKey: "Large",
     "Number_of_players":222+233
   },
   "GA": {
     fillKey: "Medium",
     "Number_of_players":362
   },
   "IL": {
     fillKey: "Medium",
     "Number_of_players":348
   },
   "IN": {
     fillKey: "Small",
     "Number_of_players":260
   },
   "LA": {
     fillKey: "Low",
     "Number_of_players":60
   },
   "MA": {
     fillKey: "Large",
     "Number_of_players":405
   },
   "MI": {
     fillKey: "Medium",
     "Number_of_players":398
   },
   "MN": {
     fillKey: "Small",
     "Number_of_players":227
   },
   "NY": {
     fillKey: "Large",
     "Number_of_players":440
   },
   "NC": {
     fillKey: "Low",
     "Number_of_players":95
   },
   "OH": {
     fillKey: "Medium",
     "Number_of_players":367
   },
   "OK": {
     fillKey: "Low",
     "Number_of_players":77
   },
   "OR": {
     fillKey: "Medium",
     "Number_of_players":319
   },
   "PA": {
     fillKey: "Large",
     "Number_of_players":416
   },
   "TN": {
     fillKey: "Low",
     "Number_of_players":147
   },

   "TX": {
     fillKey: "Huge",
     "Number_of_players":327+298+322
   },

   "UT": {
     fillKey: "Small",
     "Number_of_players":235
   },
   "WI": {
     fillKey: "Medium",
     "Number_of_players":378
   },
   "WA": {
     fillKey: "Low",
     "Number_of_players":170
   }

 }
})
map.labels();


// function to get the team after selection and put in in playerBox
function readTeamsAndYear(event){
  var notNull = 0; 
  var year = document.getElementById("seasonSelect").value.toUpperCase();
  var tm = document.getElementById("teamSelect").value.toUpperCase();
  var players = [];

  d3.csv("DATA/players_teams_seasons/"+tm+year+".csv").then (function(data) {

    for (var i = 0; i < data.length; i++) {
      players.push(data[i].Player);
      notNull = 1;
    };
    document.getElementById('players_selected').innerHTML = "";

    (listToBoxes(players));
    return false;
  });
  return false;
}; 

//make the nice selections boxes instead of ordinary ones. select by id
$('#seasonSelect').niceSelect();
$('#teamSelect').niceSelect();

function clearBuffer(){
  var checkboxesPlayers = document.getElementsByName('selectedPlayers');
  var checkboxesStats = document.getElementsByName('selectedStat');
  for (var checkboxS of checkboxesStats) {
    if (checkboxS.checked){
      checkboxS.checked = false;

    }};
    for (var checkboxS of checkboxesPlayers) {
      if (checkboxS.checked){
        checkboxS.checked = false;

      }};
      BufferStats=[];
      BufferPlayer=[];
      return false;
    };
    function listToBoxes(mylist){



      for (var i = 0; i < mylist.length; i++) {
        document.getElementById('players_selected').innerHTML += "\n";

        document.getElementById('players_selected').innerHTML += "<input type=\"checkbox\"name = selectedPlayers  id=\"players"+i+"\"  value="+(mylist[i]+'').replace(/ /g,"_")+"> ";
        document.getElementById('players_selected').innerHTML += "\n";
        document.getElementById('players_selected').innerHTML += "<font size =4><label for=\"players"+i+"\">"+mylist[i]+"</label></font><br>";

      };
      if(mylist.length<1){
        document.getElementById('players_selected').innerHTML += "<font size=10>Data Not available. Try picking a later year.</font>";
      }
      else{        document.getElementById('players_selected').innerHTML += "<button class=\"submitLarge\" type = \"submit\">Make Sanskey!</button>";

    }



    return false;
  };

  function readPlayers(event){
    var selectedPlayers = [];
    var StatsList = [];
    var checkboxesPlayers = document.getElementsByName('selectedPlayers');
    var checkboxesStats = document.getElementsByName('selectedStat');

    var indexes = [];



    for (var checkboxS of checkboxesStats) {
      if (checkboxS.checked){
        StatsList.push((checkboxS.value+''));

      }};

      console.log(StatsList);

      var year = document.getElementById("seasonSelect").value.toUpperCase();
      var tm = document.getElementById("teamSelect").value.toUpperCase();
      for (var checkboxP of checkboxesPlayers) {
        if (checkboxP.checked){
          selectedPlayers.push((checkboxP.value+'').replace("_"," ")+" "+year.slice(-2));

        }};
        if (StatsList.length < 1 ||selectedPlayers.length <1) {
          alert("Please select at least 1 player and 1 statistic to show!");
        };
        var stats = [StatsList];

        var players = [];
        d3.csv("DATA/players_teams_seasons/"+tm+year+".csv").then (function(data) {
          for (var i = 0; i < data.length; i++) {
            for (var j = 0; j<selectedPlayers.length; j++) {
              var temp = [];
              if (selectedPlayers[j] == data[i].Player+" "+year.slice(-2)) {
                for(var k of StatsList){
                  temp.push(Number(data[i][k]));
                };
                stats.push(temp);
                  }; // end if
                };// end for j
              }; // end for i

              console.log(selectedPlayers);
              updateDiagram(selectedPlayers, stats);
              return false;
    }); // end read csv
        return false;

      };
      var BufferStats=[];
      var BufferPlayer=[];

      function isInList(k, list){
        for (var i = 0; i < list.length; i++) {
          if(list[i] == k){
            return true;
          }
        };
        return false;
      };

      function  updateDiagram(selectedPlayers,s){
        document.getElementById('selectPlayerMap').innerHTML = "";
        BufferStats[0] = s[0];
        for (var i=0;i<s.length-1; i++){

         BufferStats.push(s[i+1]);
       };
       for (var k of selectedPlayers){

        if(!(isInList(k,BufferPlayer))){
          BufferPlayer.push(k);};
        };

        playersList = BufferPlayer;
        stats = BufferStats;
        drawChart();
        for (var player of BufferPlayer) {
          document.getElementById('selectPlayerMap').innerHTML += "<option value=\""+(player+'').replace(/ /g,"_")+"\">"+(player+'').slice(0,-3)+"</option>";
        };
        document.getElementById('selectPlayerMap').innerHTML += "<input name=\"playersMap\" class = \"submitMap\" type=\"submit\" value=\"GO!\" >";
        document.getElementById('selectPlayerMap').innerHTML += "</select>";
        return false;
      };
    </script>    </section><!-- #Visualisation -->
    

  <!--==========================
    Footer
    ============================-->
    <footer id="footer">
      <div class="footer-top">
        <div class="container">

        </div>
      </div>

      <div class="container">
        <div class="copyright">
          &copy; Copyright <strong>Regna</strong>. All Rights Reserved
        </div>
        <div class="credits">
        <!--
          All the links in the footer should remain intact.
          You can delete the links only if you purchased the pro version.
          Licensing information: https://bootstrapmade.com/license/
          Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=Regna
        -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- #footer -->

  <a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>

  <!-- JavaScript Libraries -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/jquery/jquery-migrate.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/wow/wow.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/counterup/counterup.min.js"></script>
  <script src="lib/superfish/hoverIntent.js"></script>
  <script src="lib/superfish/superfish.min.js"></script>

  <!-- Contact Form JavaScript File -->
  <script src="contactform/contactform.js"></script>

  <!-- Template Main Javascript File -->
  <script src="js/main.js"></script>

</body>
</html>
